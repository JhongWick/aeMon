@model List<Entities.Region>
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

<style>
    #myDialog {
        background-color: white !important;
    }

    .dataTables_filter {
        float: left;
        text-align: left;
    }
</style>


<div class="box box-warning">
    <div class="box-header">
        <h3 class="box-title"><i class="fa fa-location-arrow"></i> Regions</h3>
        <a href="#" onclick="AddNew()" class="btn  btn-sm btn-primary pull-right"><i class="fa fa-plus-square"></i>&nbsp;&nbsp;Add Region</a>
    </div>
    <!-- /.box-header -->
    <div class="box-body">
        <table width="100%" class="table table-striped table-bordered table-hover" id="dataTables-example">
            <thead>
                <tr>
                    <th>Region #</th>
                    <th>Name</th>
                    <th>Code</th>

                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var entity in Model)
                {
                    <tr id="row_@entity.RegionId" class="odd gradeX">
                        <td>@entity.RegionId</td>
                        <td>@entity.Name</td>
                        <td>@entity.Code</td>

                        <td class="center">
                            <a href="#" class="btn btn-success  btn-sm" onclick="EditModule(@entity.RegionId)"><i class="glyphicon glyphicon-pencil"></i></a>

                            <a href="#" id="btnDelete" class="btn btn-danger btn-sm" onclick="DeleteModule(@entity.RegionId)"><i class="glyphicon glyphicon-trash"></i></a>

                        </td>

                    </tr>
                }

            </tbody>
        </table>
    </div>
    <!-- /.box-body -->
</div>
<!-- /.box -->
<!-- /.row -->
<div class="modal fade" id="myModal">
    <div class="modal-dialog" id="myDialog">
        <div class="modal-content">
            <div class="modal-header">
                <a href="#" class="close" data-dismiss="modal">&times;</a>
                <h3 class="modal-title" id="modaltitle"></h3>
            </div>
        </div>
        <div class="modal-body" id="myModalBodyDiv">
            <span>Add New</span>
        </div>
        <div class="modal-footer">
            <a href="#" class="btn btn-default" data-dismiss="modal">Cancel</a>

            <a href="#" class="btn btn-success" onclick="DeleteUser()">Confirm</a>
        </div>
    </div>
</div>





<script>
    $(function () {
        $('#dataTables-example').DataTable({
            responsive: true
        });
        $("#myModal").on("click", "#submitAdd", function () {
            if (validSubmit()) {
                $("#formAdd").submit();
            }
        });
        $("#myModal").on("click", "#submitEdit", function () {
            if (validSubmit()) {
                $("#formEdit").submit();
            }
        });
    });

    var isModuleDeleted = function () {
        if ($('#isDeleted').is(':checked')) {
            $('#isDeleted').val('true');
        } else {
            $('#isDeleted').val('false');
        }
    }

    var AddNew = function () {
        var url = "/Regions/Add";
        $("#myModalBodyDiv").load(url, function () {
            $("#modaltitle").text('Add Module');
            $("#myModal").modal("show");
            $(".modal-footer").hide();
            $("#error-display").hide();
        })
    }

    var EditModule = function (id) {
        var url = "/Regions/Edit";
        $.ajax({
            type: "GET",
            url: url,
            data: { RegionId: id },
            success: function (result) {
                $("#myModalBodyDiv").html(result);
                $("#myModal").modal("show");
                $(".modal-title").text('Edit Module?');
                $(".modal-footer").hide();
                $("#error-display").hide();
            }
        })
    }

    var DeleteModule = function (id) {
        var url = "/Regions/Delete";
        $.ajax({
            type: "GET",
            url: url,
            data: { RegionId: id },
            success: function (result) {
                $("#myModalBodyDiv").html(result);
                $("#myModal").modal("show");
                $(".modal-title").text('Delete Module?');
                $(".modal-footer").hide();
            }
        })
    }

    function validSubmit() {
        $('#error-display').hide();
        valid = true;
       
        if ($('#Name').val().trim().length == 0) {
            valid = false;
            modControllerError = "Region Name";
        } else {
            modControllerError = "";
        }
        if ($('#Code').val().trim().length == 0) {
            valid = false;
            modActionError = "Region COde";
        } else {
            modActionError = "";
        }
        if (!valid) {
            errorMsg =  modControllerError + " " + modActionError;
            $('#error-display').html("Error! Required field(s): <i>" + errorMsg.trim() + "</i>");
            $('#error-display').show();
        }
        return valid;
    }
</script>





